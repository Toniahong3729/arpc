<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>GIGABYTE STEALTH AR</title>
    <!-- åŸºç¤ A-Frame -->
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <!-- åŸºç¤ AR.js -->
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <!-- UI æ¨£å¼ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap');
        
        body, html { 
            margin: 0; padding: 0; width: 100%; height: 100%; 
            overflow: hidden; font-family: 'Orbitron', sans-serif; background: #000; 
            position: fixed; left: 0; top: 0; right: 0; bottom: 0;
        }

        /* çµ‚æ¥µä¿®å¾©ï¼šå¼·åˆ¶æ’é–‹æ‰€æœ‰ AR ç›¸é—œå…ƒä»¶ */
        video, .a-canvas, a-scene {
            width: 100% !important;
            height: 100% !important;
            top: 0 !important;
            left: 0 !important;
            position: fixed !important;
            object-fit: cover !important;
            margin: 0 !important;
        }

        #landing-page {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at center, #1a1a1a 0%, #000 100%);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            z-index: 1000; transition: opacity 0.5s ease;
        }

        .btn-aorus { 
            background: linear-gradient(135deg, #ff6600 0%, #cc5200 100%); 
            color: white; padding: 16px 40px; border-radius: 50px;
            font-weight: bold; text-transform: uppercase; letter-spacing: 2px;
            box-shadow: 0 0 20px rgba(255, 102, 0, 0.4); border: none; cursor: pointer;
        }

        .ui-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 100;
        }

        .aorus-panel { 
            background: rgba(0, 0, 0, 0.85); border: 1px solid #ff6600; 
            color: white; padding: 25px; border-radius: 15px; text-align: center;
            pointer-events: auto; backdrop-filter: blur(10px); width: 85%; max-width: 360px;
            position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%);
        }

        /* é ‚éƒ¨æƒææç¤º */
        #top-guide {
            position: absolute; top: 30px; left: 0; width: 100%;
            display: flex; flex-direction: column; align-items: center;
            z-index: 60;
        }

        .top-label {
            background: rgba(255, 102, 0, 0.9); color: black;
            padding: 4px 15px; border-radius: 20px; font-size: 10px; font-weight: bold;
            margin-bottom: 8px; box-shadow: 0 0 10px #ff6600;
        }

        #ar-instruction {
            background: rgba(0,0,0,0.7); border: 1px solid #ff6600;
            color: #ff6600; padding: 10px 20px; border-radius: 30px;
            font-size: 12px; text-align: center;
        }

        /* æƒæå¼•å°æ¡† (å¤§é‚Šæ¡†ï¼Œä¸é®æ“‹ä¸­å¤®) */
        .scan-viewfinder {
            position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%);
            width: 70vw; height: 70vw; max-width: 280px; max-height: 280px;
            border: 1px solid rgba(255, 102, 0, 0.3);
            border-radius: 20px; pointer-events: none;
        }
        .scan-viewfinder::before {
            content: ''; position: absolute; width: 30px; height: 30px;
            top: -2px; left: -2px; border-top: 4px solid #ff6600; border-left: 4px solid #ff6600; border-radius: 10px 0 0 0;
        }
        .scan-viewfinder::after {
            content: ''; position: absolute; width: 30px; height: 30px;
            bottom: -2px; right: -2px; border-bottom: 4px solid #ff6600; border-right: 4px solid #ff6600; border-radius: 0 0 10px 0;
        }

        .hidden { display: none !important; }

        #error-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 2000;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            padding: 30px; text-align: center; color: white;
        }

        .a-enter-vr { display: none !important; }
    </style>
</head>
<body>

    <!-- éŒ¯èª¤æç¤ºå±¤ -->
    <div id="error-overlay" class="hidden">
        <div class="text-[#ff6600] text-5xl mb-6">âš ï¸</div>
        <h2 class="text-xl font-bold mb-4">ç›¸æ©Ÿå•Ÿå‹•ç•°å¸¸</h2>
        <p class="text-sm text-gray-400 mb-8 font-sans">è«‹ç¢ºä¿å·²åœ¨ç€è¦½å™¨è¨­å®šä¸­å…è¨±ç›¸æ©Ÿæ¬Šé™ã€‚</p>
        <button onclick="location.reload()" class="btn-aorus text-sm">é‡æ–°æ•´ç†</button>
    </div>

    <!-- å•Ÿå‹•ä¸»ç•«é¢ -->
    <div id="landing-page">
        <div class="text-center px-10">
            <div class="mb-8">
                <div class="w-20 h-20 bg-[#ff6600] rounded-full mx-auto flex items-center justify-center shadow-2xl shadow-[#ff6600]/40">
                    <span class="text-2xl font-black text-black">GS</span>
                </div>
            </div>
            <h1 class="text-3xl font-bold text-white mb-2">STEALTH <span class="text-[#ff6600]">AR</span></h1>
            <p class="text-gray-400 text-xs tracking-widest mb-12 uppercase font-sans">GIGABYTE INTERACTIVE</p>
            
            <button id="main-start-btn" onclick="requestCameraAndInit()" class="btn-aorus">
                é–‹å§‹æ´»å‹•
            </button>
            <p class="mt-8 text-[10px] text-gray-600 font-sans tracking-widest">v2.3 STABLE</p>
        </div>
    </div>

    <!-- UI é‡ç–Šå±¤ -->
    <div id="ui-container" class="ui-overlay hidden">
        
        <!-- é ‚éƒ¨æç¤º (å–ä»£ä¸­å¤®å¤§é¢æ¿) -->
        <div id="top-guide">
            <div class="top-label">STEALTH SCANNER</div>
            <div id="ar-instruction">è«‹å°‡ Hiro æ¨™èªŒå°æº–æ–¹æ¡†ä¸­å¤®</div>
        </div>

        <!-- é€æ˜æƒææ–¹æ¡† -->
        <div id="scan-frame" class="scan-viewfinder">
            <div class="absolute inset-0 flex items-center justify-center">
                <div class="w-full h-[1px] bg-[#ff6600]/20 animate-pulse"></div>
            </div>
        </div>

        <!-- å•ç­”é¢æ¿ -->
        <div id="quiz-panel" class="aorus-panel hidden text-left">
            <div id="quiz-progress" class="text-[10px] text-[#ff6600] mb-2 font-bold text-right font-sans">Q: 1 / 5</div>
            <h2 id="question-text" class="text-base font-bold mb-6"></h2>
            <div id="options-container" class="grid gap-3"></div>
        </div>

        <!-- æˆåŠŸå‹³ç«  -->
        <div id="medal-panel" class="aorus-panel hidden">
            <div class="text-5xl mb-4">ğŸ†</div>
            <h2 class="text-2xl font-bold text-[#ff6600] mb-2">æŒ‘æˆ°å®Œæˆ</h2>
            <div class="bg-[#ff6600]/10 py-4 border border-[#ff6600]/30 rounded-lg mb-6 mt-4">
                <span class="text-2xl font-black tracking-widest text-[#ff6600]">STEALTH-PRO</span>
            </div>
            <button onclick="location.reload()" class="text-xs text-gray-500 underline">é‡æ–°æŒ‘æˆ°</button>
        </div>
    </div>

    <div id="scene-container"></div>

    <script>
        const questions = [
            { q: "æŠ€å˜‰ STEALTH ç³»åˆ—æœ€ä¸»è¦çš„è¨­è¨ˆæ ¸å¿ƒæ˜¯ä»€éº¼ï¼Ÿ", o: ["ç„¡ç·šå‚³è¼¸", "èƒŒæ’å¼ä»‹é¢è¨­è¨ˆ", "è¶…å¤§å‹æ•£ç†±æ‰‡", "å…¨é€æ˜å¤–æ®¼"], a: 1 },
            { q: "èƒŒæ’å¼è¨­è¨ˆå¦‚ä½•å½±éŸ¿é›»è…¦æ•£ç†±ï¼Ÿ", o: ["å¢åŠ é¢¨æ‰‡è½‰é€Ÿ", "é™ä½é›»åŠ›æ¶ˆè€—", "ç†ç·šæ•´æ½”ä¸¦å„ªåŒ–é¢¨é“", "å¢åŠ æ©Ÿæ®¼é‡é‡"], a: 2 },
            { q: "STEALTH ç³»åˆ—é€šå¸¸æ­é…å“ªå€‹é«˜ç«¯å­å“ç‰Œï¼Ÿ", o: ["AORUS", "AERO", "EAGLE", "GAMING"], a: 0 },
            { q: "ä½¿ç”¨ STEALTH æ–¹æ¡ˆé€²è¡Œçµ„è£ï¼Œä¸»è¦èƒ½è§£æ±ºä»€éº¼ç—›é»ï¼Ÿ", o: ["ç†ç·šç¹é›œèˆ‡è¦–è¦ºæ··äº‚", "ç¡¬ç¢Ÿç©ºé–“ä¸è¶³", "é¡¯ç¤ºå¡å¤ªé‡", "è¢å¹•è§£æåº¦ä¸è¶³"], a: 0 },
            { q: "STEALTH ç³»åˆ—çš„è¦–è¦ºç‰¹é»ç‚ºä½•ï¼Ÿ", o: ["å……æ»¿å¤§é‡ RGB", "å¹¾ä¹çœ‹ä¸åˆ°å¤–éœ²ç·šæ", "æ©Ÿæ®¼å‘ˆç¾å…¨é»ƒè‰²", "éœ€è¦ä½¿ç”¨æ°´å†·"], a: 1 }
        ];

        let currentQuestion = 0;
        let markerFound = false;

        async function requestCameraAndInit() {
            try {
                // æª¢æŸ¥ç›¸æ©Ÿæ¬Šé™
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { facingMode: 'environment' } 
                });
                stream.getTracks().forEach(track => track.stop());
                initAR();
            } catch (err) {
                document.getElementById('error-overlay').classList.remove('hidden');
            }
        }

        function initAR() {
            document.getElementById('landing-page').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('landing-page').classList.add('hidden');
                document.getElementById('ui-container').classList.remove('hidden');
            }, 500);

            // ä¿®æ­£ï¼šç§»é™¤ embeddedï¼Œè®“ A-Frame å…¨æ¬Šè™•ç†ä½ˆå±€
            const sceneHTML = `
                <a-scene 
                    loading-screen="enabled: false"
                    arjs="sourceType: webcam; debugUIEnabled: false; displayWidth: ${window.innerWidth}; displayHeight: ${window.innerHeight};" 
                    renderer="antialias: true; alpha: true; precision: medium;" 
                    vr-mode-ui="enabled: false">
                    
                    <a-marker preset="hiro" id="stealth-marker">
                        <a-entity position="0 0.5 0" animation="property: rotation; to: 0 360 0; loop: true; dur: 4000; easing: linear">
                            <a-box position="0 0 0" material="color: #000; opacity: 0.8" scale="1 1 1">
                                <a-box position="0 0 0" scale="0.9 0.9 0.9" material="color: #111; emissive: #ff6600; emissiveIntensity: 0.7"></a-box>
                            </a-box>
                            <a-text value="STEALTH ACTIVE" position="0 1.2 0" align="center" color="#ff6600" width="3"></a-text>
                        </a-entity>
                    </a-marker>
                    
                    <a-entity camera></a-entity>
                </a-scene>
            `;
            document.getElementById('scene-container').innerHTML = sceneHTML;

            // æ¯ç§’åŸ·è¡Œä¸€æ¬¡å¸ƒå±€ä¿®å¾©ï¼Œå°æŠ—ç§»å‹•è¨­å‚™çš„å‹•æ…‹ UI è®ŠåŒ–
            const forceLayout = () => {
                const els = ['video', '.a-canvas', 'a-scene'];
                els.forEach(s => {
                    const el = document.querySelector(s);
                    if (el) {
                        el.style.setProperty('width', window.innerWidth + 'px', 'important');
                        el.style.setProperty('height', window.innerHeight + 'px', 'important');
                    }
                });
            };
            setInterval(forceLayout, 1000);

            // ç›£è½æƒæ
            setTimeout(() => {
                const marker = document.querySelector('#stealth-marker');
                if (marker) {
                    marker.addEventListener('markerFound', () => {
                        if(!markerFound) triggerQuiz();
                    });
                }
            }, 2500);
        }

        function triggerQuiz() {
            markerFound = true;
            document.getElementById('ar-instruction').innerText = "è¾¨è­˜æˆåŠŸï¼é–‹å§‹æŒ‘æˆ°";
            document.getElementById('ar-instruction').style.background = "#4CAF50";
            document.getElementById('ar-instruction').style.color = "white";
            document.getElementById('scan-frame').classList.add('hidden');
            
            setTimeout(() => {
                document.getElementById('top-guide').classList.add('hidden');
                document.getElementById('quiz-panel').classList.remove('hidden');
                loadQuestion();
            }, 1000);
        }

        function loadQuestion() {
            const q = questions[currentQuestion];
            document.getElementById('quiz-progress').innerText = `Q: ${currentQuestion + 1} / ${questions.length}`;
            document.getElementById('question-text').innerText = q.q;
            const container = document.getElementById('options-container');
            container.innerHTML = '';
            
            q.o.forEach((option, index) => {
                const btn = document.createElement('button');
                btn.className = "w-full text-left p-4 rounded-lg bg-white/10 border border-white/20 text-white text-sm active:bg-[#ff6600] transition-all font-sans";
                btn.innerText = option;
                btn.onclick = () => {
                    if (index === q.a) {
                        btn.classList.add('bg-green-600', 'border-green-600');
                        setTimeout(() => {
                            currentQuestion++;
                            if (currentQuestion < questions.length) loadQuestion();
                            else showMedal();
                        }, 500);
                    } else {
                        btn.classList.add('bg-red-600', 'border-red-600');
                        setTimeout(() => btn.classList.remove('bg-red-600', 'border-red-600'), 500);
                    }
                };
                container.appendChild(btn);
            });
        }

        function showMedal() {
            document.getElementById('quiz-panel').classList.add('hidden');
            document.getElementById('medal-panel').classList.remove('hidden');
        }
    </script>
</body>
</html>
