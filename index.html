<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>GIGABYTE STEALTH AR</title>
    <!-- åŸºç¤ A-Frame -->
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <!-- åŸºç¤ AR.js -->
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <!-- UI æ¨£å¼ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap');
        
        body, html { 
            margin: 0; padding: 0; width: 100%; height: 100%; 
            overflow: hidden; font-family: 'Orbitron', sans-serif; background: #000; 
            position: fixed; /* é˜²æ­¢æ©¡çš®ç­‹æ»¾å‹•æ•ˆæœ */
        }

        /* ä¿®æ­£ç›¸æ©Ÿå½±åƒä½ˆå±€ï¼Œå¼·åˆ¶å…¨è¢å¹•æ¸²æŸ“ */
        video, .a-canvas {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100vw !important;
            height: 100vh !important;
            object-fit: cover !important;
            z-index: -10 !important;
        }

        #landing-page {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at center, #1a1a1a 0%, #000 100%);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            z-index: 1000; transition: opacity 0.5s ease;
        }

        .btn-aorus { 
            background: linear-gradient(135deg, #ff6600 0%, #cc5200 100%); 
            color: white; padding: 16px 40px; border-radius: 50px;
            font-weight: bold; text-transform: uppercase; letter-spacing: 2px;
            box-shadow: 0 0 20px rgba(255, 102, 0, 0.4); border: none; cursor: pointer;
        }

        .ui-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 100;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }

        .aorus-panel { 
            background: rgba(0, 0, 0, 0.85); border: 1px solid #ff6600; 
            color: white; padding: 25px; border-radius: 15px; text-align: center;
            pointer-events: auto; backdrop-filter: blur(10px); width: 85%; max-width: 400px;
        }

        #ar-instruction {
            position: absolute; bottom: 50px; width: 80%;
            background: rgba(0,0,0,0.8); border: 1px solid #ff6600;
            color: #ff6600; padding: 10px; border-radius: 30px;
            font-size: 12px; text-align: center; z-index: 50;
        }

        .hidden { display: none !important; }

        .marker-sample {
            width: 100px; height: 100px; background: white; border: 12px solid black;
            display: flex; align-items: center; justify-content: center;
            margin: 0 auto 15px;
        }
        .marker-sample span { color: black; font-weight: bold; font-size: 18px; font-family: sans-serif; }

        #error-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 2000;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            padding: 30px; text-align: center; color: white;
        }

        /* éš±è— A-Frame çš„å°è©±æ¡† */
        .a-enter-vr { display: none !important; }
    </style>
</head>
<body>

    <!-- éŒ¯èª¤æç¤ºå±¤ -->
    <div id="error-overlay" class="hidden">
        <div class="text-[#ff6600] text-5xl mb-6">âš ï¸</div>
        <h2 class="text-xl font-bold mb-4">éœ€è¦ç›¸æ©Ÿæ¬Šé™</h2>
        <p id="error-text" class="text-sm text-gray-400 mb-8 leading-relaxed">è«‹ç¢ºä¿å·²å…è¨±ç€è¦½å™¨å­˜å–ç›¸æ©Ÿã€‚</p>
        <button onclick="location.reload()" class="btn-aorus text-sm">é‡è©¦ä¸€é</button>
    </div>

    <!-- å•Ÿå‹•ä¸»ç•«é¢ -->
    <div id="landing-page">
        <div class="text-center px-10">
            <div class="mb-8">
                <div class="w-20 h-20 bg-[#ff6600] rounded-full mx-auto flex items-center justify-center shadow-2xl shadow-[#ff6600]/40">
                    <span class="text-2xl font-black text-black">GS</span>
                </div>
            </div>
            <h1 class="text-3xl font-bold text-white mb-2">STEALTH <span class="text-[#ff6600]">AR</span></h1>
            <p class="text-gray-400 text-xs tracking-widest mb-12 uppercase">GIGABYTE INTERACTIVE</p>
            
            <button id="main-start-btn" onclick="requestCameraAndInit()" class="btn-aorus">
                é€²å…¥ AR æŒ‘æˆ°
            </button>
            
            <p class="mt-8 text-[10px] text-gray-500">å»ºè­°ä½¿ç”¨ Chrome æˆ– Safari ä»¥ç²å¾—æœ€ä½³é«”é©—</p>
        </div>
    </div>

    <!-- UI é‡ç–Šå±¤ -->
    <div id="ui-container" class="ui-overlay hidden">
        <div id="ar-instruction">æ­£åœ¨å°‹æ‰¾ STEALTH æ¨™èªŒ (Hiro Marker)...</div>

        <!-- æƒææç¤ºæ¡† -->
        <div id="start-panel" class="aorus-panel">
            <h2 class="text-[#ff6600] font-bold mb-4">æº–å‚™æƒæ</h2>
            <div class="marker-sample">
                <span>HIRO</span>
            </div>
            <p class="text-sm text-gray-300 mb-6">è«‹å°‡é¡é ­å°æº–é›»è…¦è¢å¹•ä¸Šçš„ <br><strong>Hiro Marker (å¦‚ä¸Šåœ–)</strong></p>
            <div class="w-12 h-12 border-2 border-[#ff6600] border-dashed mx-auto animate-pulse"></div>
        </div>

        <!-- å•ç­”é¢æ¿ -->
        <div id="quiz-panel" class="aorus-panel hidden">
            <div id="quiz-progress" class="text-[10px] text-[#ff6600] mb-2 font-bold text-right">Q: 1 / 5</div>
            <h2 id="question-text" class="text-base font-bold mb-6 text-left"></h2>
            <div id="options-container" class="grid gap-3"></div>
        </div>

        <!-- æˆåŠŸå‹³ç«  -->
        <div id="medal-panel" class="aorus-panel hidden">
            <div class="text-5xl mb-4">ğŸ†</div>
            <h2 class="text-2xl font-bold text-[#ff6600] mb-2">æŒ‘æˆ°å®Œæˆ</h2>
            <p class="text-xs text-gray-400 mb-6">æ‚¨å·²æˆåŠŸæŒæ¡ STEALTH æŠ€è¡“æ ¸å¿ƒ</p>
            <div class="bg-[#ff6600]/10 py-4 border border-[#ff6600]/30 rounded-lg mb-6">
                <span class="text-2xl font-black tracking-widest text-[#ff6600]">STEALTH-PRO</span>
            </div>
            <button onclick="location.reload()" class="text-xs text-gray-500 underline">é‡æ–°æŒ‘æˆ°</button>
        </div>
    </div>

    <!-- å®¹å™¨ç”¨æ–¼æ³¨å…¥ AR å ´æ™¯ -->
    <div id="scene-container"></div>

    <script>
        const questions = [
            { q: "æŠ€å˜‰ STEALTH ç³»åˆ—æœ€ä¸»è¦çš„è¨­è¨ˆæ ¸å¿ƒæ˜¯ä»€éº¼ï¼Ÿ", o: ["ç„¡ç·šå‚³è¼¸", "èƒŒæ’å¼ä»‹é¢è¨­è¨ˆ", "è¶…å¤§å‹æ•£ç†±æ‰‡", "å…¨é€æ˜å¤–æ®¼"], a: 1 },
            { q: "èƒŒæ’å¼è¨­è¨ˆå¦‚ä½•å½±éŸ¿é›»è…¦æ•£ç†±ï¼Ÿ", o: ["å¢åŠ é¢¨æ‰‡è½‰é€Ÿ", "é™ä½é›»åŠ›æ¶ˆè€—", "ç†ç·šæ•´æ½”ä¸¦å„ªåŒ–é¢¨é“", "å¢åŠ æ©Ÿæ®¼é‡é‡"], a: 2 },
            { q: "STEALTH ç³»åˆ—é€šå¸¸æ­é…å“ªå€‹é«˜ç«¯å­å“ç‰Œï¼Ÿ", o: ["AORUS", "AERO", "EAGLE", "GAMING"], a: 0 },
            { q: "ä½¿ç”¨ STEALTH æ–¹æ¡ˆé€²è¡Œçµ„è£ï¼Œä¸»è¦èƒ½è§£æ±ºä»€éº¼ç—›é»ï¼Ÿ", o: ["ç†ç·šç¹é›œèˆ‡è¦–è¦ºæ··äº‚", "ç¡¬ç¢Ÿç©ºé–“ä¸è¶³", "é¡¯ç¤ºå¡å¤ªé‡", "è¢å¹•è§£æåº¦ä¸è¶³"], a: 0 },
            { q: "STEALTH ç³»åˆ—çš„è¦–è¦ºç‰¹é»ç‚ºä½•ï¼Ÿ", o: ["å……æ»¿å¤§é‡ RGB", "å¹¾ä¹çœ‹ä¸åˆ°å¤–éœ²ç·šæ", "æ©Ÿæ®¼å‘ˆç¾å…¨é»ƒè‰²", "éœ€è¦ä½¿ç”¨æ°´å†·"], a: 1 }
        ];

        let currentQuestion = 0;
        let markerFound = false;

        async function requestCameraAndInit() {
            try {
                // æª¢æŸ¥æ˜¯å¦ç‚º iOS ä¸¦æç¤ºå»ºè­°ç€è¦½å™¨
                const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
                if (isIOS && !window.navigator.standalone && !/Safari/.test(navigator.userAgent)) {
                    // å¦‚æœåœ¨ LINE æˆ– FB å…§å»ºç€è¦½å™¨ï¼Œé€™é€šå¸¸æœƒå°è‡´æ¬Šé™å•é¡Œ
                    console.warn("Detected non-Safari on iOS");
                }

                const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } });
                stream.getTracks().forEach(track => track.stop());
                initAR();
            } catch (err) {
                console.error("Camera error:", err);
                document.getElementById('error-overlay').classList.remove('hidden');
                document.getElementById('error-text').innerText = "ç›¸æ©Ÿå•Ÿå‹•å¤±æ•—ã€‚è«‹ç¢ºèªæ‚¨ä½¿ç”¨çš„æ˜¯ Safari æˆ– Chromeï¼Œä¸”å·²æˆæ¬Šæ”å½±æ©Ÿä½¿ç”¨æ¬Šé™ã€‚";
            }
        }

        function initAR() {
            document.getElementById('landing-page').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('landing-page').classList.add('hidden');
                document.getElementById('ui-container').classList.remove('hidden');
            }, 500);

            // ä¿®æ­£ A-Frame åœ¨æŸäº›æ‰‹æ©Ÿä¸Šç¸®æˆå°æ–¹å¡Šçš„å•é¡Œ
            // å¼·åˆ¶è®“ AR.js æŠ“å–ç•¶å‰è¦–çª—å¤§å°
            const sceneHTML = `
                <a-scene 
                    embedded 
                    loading-screen="enabled: false"
                    arjs="sourceType: webcam; debugUIEnabled: false; displayWidth: ${window.innerWidth}; displayHeight: ${window.innerHeight};" 
                    renderer="antialias: true; alpha: true; precision: medium;" 
                    vr-mode-ui="enabled: false">
                    
                    <a-marker preset="hiro" id="stealth-marker">
                        <a-entity position="0 0.5 0" animation="property: rotation; to: 0 360 0; loop: true; dur: 5000; easing: linear">
                            <a-box position="0 0 0" material="color: #000; opacity: 0.8" scale="1 1 1">
                                <a-box position="0 0 0" scale="0.9 0.9 0.9" material="color: #111; emissive: #ff6600; emissiveIntensity: 0.6"></a-box>
                            </a-box>
                            <a-text value="STEALTH MODE" position="0 1.2 0" align="center" color="#ff6600" width="3" font="mozillavr"></a-text>
                        </a-entity>
                    </a-marker>
                    
                    <a-entity camera></a-entity>
                </a-scene>
            `;
            document.getElementById('scene-container').innerHTML = sceneHTML;

            // å»¶é²ç¶å®š marker äº‹ä»¶ç¢ºä¿å ´æ™¯å·²å®Œå…¨å»ºç«‹
            setTimeout(() => {
                const marker = document.querySelector('#stealth-marker');
                if (marker) {
                    marker.addEventListener('markerFound', () => {
                        if(!markerFound) triggerQuiz();
                    });
                }
                
                // å¼·åˆ¶è§¸ç™¼ä¸€æ¬¡ resize ç¢ºä¿ä½ˆå±€æ­£ç¢º
                window.dispatchEvent(new Event('resize'));
            }, 1500);
        }

        function triggerQuiz() {
            markerFound = true;
            document.getElementById('ar-instruction').innerText = "åµæ¸¬æˆåŠŸï¼";
            document.getElementById('ar-instruction').style.color = "#4CAF50";
            
            setTimeout(() => {
                document.getElementById('start-panel').classList.add('hidden');
                document.getElementById('ar-instruction').classList.add('hidden');
                document.getElementById('quiz-panel').classList.remove('hidden');
                loadQuestion();
            }, 1000);
        }

        function loadQuestion() {
            const q = questions[currentQuestion];
            document.getElementById('quiz-progress').innerText = `Q: ${currentQuestion + 1} / ${questions.length}`;
            document.getElementById('question-text').innerText = q.q;
            const container = document.getElementById('options-container');
            container.innerHTML = '';
            
            q.o.forEach((option, index) => {
                const btn = document.createElement('button');
                btn.className = "w-full text-left p-4 rounded-lg bg-white/5 border border-white/10 text-white text-sm active:bg-[#ff6600]/20 transition-all";
                btn.innerText = option;
                btn.onclick = () => {
                    if (index === q.a) {
                        btn.classList.add('bg-green-600', 'border-green-600');
                        setTimeout(() => {
                            currentQuestion++;
                            if (currentQuestion < questions.length) loadQuestion();
                            else showMedal();
                        }, 500);
                    } else {
                        btn.classList.add('bg-red-600', 'border-red-600');
                        setTimeout(() => btn.classList.remove('bg-red-600', 'border-red-600'), 500);
                    }
                };
                container.appendChild(btn);
            });
        }

        function showMedal() {
            document.getElementById('quiz-panel').classList.add('hidden');
            document.getElementById('medal-panel').classList.remove('hidden');
        }

        // ç›£è½è¢å¹•æ—‹è½‰æˆ–å¤§å°æ”¹è®Šï¼Œå¼·åˆ¶ä¿®æ­£ AR è¦–è¨Šæ¯”ä¾‹
        window.addEventListener('resize', () => {
            const video = document.querySelector('video');
            const canvas = document.querySelector('.a-canvas');
            if (video) {
                video.style.width = window.innerWidth + 'px';
                video.style.height = window.innerHeight + 'px';
            }
            if (canvas) {
                canvas.style.width = window.innerWidth + 'px';
                canvas.style.height = window.innerHeight + 'px';
            }
        });
    </script>
</body>
</html>
