<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>GIGABYTE STEALTH AR</title>
    <!-- åŸºç¤ A-Frame -->
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <!-- åŸºç¤ AR.js -->
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <!-- UI æ¨£å¼ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap');
        
        body, html { 
            margin: 0; padding: 0; width: 100%; height: 100%; 
            overflow: hidden; font-family: 'Orbitron', sans-serif; background: #000; 
            position: fixed;
        }

        /* çµ•å°å¼·åˆ¶å…¨è¢å¹•ï¼šè§£æ±ºç•«é¢ç¸®å°è®Šé»‘çš„æ ¸å¿ƒä¿®æ­£ */
        #scene-container, a-scene, .a-canvas, video {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
            margin: 0 !important;
            padding: 0 !important;
            object-fit: cover !important;
        }

        video {
            z-index: -10 !important;
        }

        #landing-page {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at center, #1a1a1a 0%, #000 100%);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            z-index: 1000; transition: opacity 0.5s ease;
        }

        .btn-aorus { 
            background: linear-gradient(135deg, #ff6600 0%, #cc5200 100%); 
            color: white; padding: 16px 40px; border-radius: 50px;
            font-weight: bold; text-transform: uppercase; letter-spacing: 2px;
            box-shadow: 0 0 20px rgba(255, 102, 0, 0.4); border: none; cursor: pointer;
        }

        .ui-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 100;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }

        .aorus-panel { 
            background: rgba(0, 0, 0, 0.85); border: 1px solid #ff6600; 
            color: white; padding: 25px; border-radius: 15px; text-align: center;
            pointer-events: auto; backdrop-filter: blur(10px); width: 85%; max-width: 400px;
        }

        #ar-instruction {
            position: absolute; bottom: 80px; width: 80%;
            background: rgba(0,0,0,0.8); border: 1px solid #ff6600;
            color: #ff6600; padding: 12px; border-radius: 30px;
            font-size: 13px; text-align: center; z-index: 50;
        }

        .hidden { display: none !important; }

        .marker-sample {
            width: 100px; height: 100px; background: white; border: 12px solid black;
            display: flex; align-items: center; justify-content: center;
            margin: 0 auto 15px;
        }
        .marker-sample span { color: black; font-weight: bold; font-size: 18px; font-family: sans-serif; }

        #error-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 2000;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            padding: 30px; text-align: center; color: white;
        }

        .a-enter-vr { display: none !important; }
    </style>
</head>
<body>

    <!-- éŒ¯èª¤æç¤ºå±¤ -->
    <div id="error-overlay" class="hidden">
        <div class="text-[#ff6600] text-5xl mb-6">âš ï¸</div>
        <h2 class="text-xl font-bold mb-4">ç›¸æ©Ÿå•Ÿå‹•ç•°å¸¸</h2>
        <p id="error-text" class="text-sm text-gray-400 mb-8 leading-relaxed">è«‹ç¢ºèªæ˜¯å¦å·²æˆæ¬Šç›¸æ©Ÿæ¬Šé™ï¼Œä¸¦å»ºè­°ä½¿ç”¨ Safari æˆ– Chrome ç€è¦½å™¨ã€‚</p>
        <button onclick="location.reload()" class="btn-aorus text-sm">é‡æ–°å˜—è©¦</button>
    </div>

    <!-- å•Ÿå‹•ä¸»ç•«é¢ -->
    <div id="landing-page">
        <div class="text-center px-10">
            <div class="mb-8">
                <div class="w-20 h-20 bg-[#ff6600] rounded-full mx-auto flex items-center justify-center shadow-2xl shadow-[#ff6600]/40">
                    <span class="text-2xl font-black text-black">GS</span>
                </div>
            </div>
            <h1 class="text-3xl font-bold text-white mb-2">STEALTH <span class="text-[#ff6600]">AR</span></h1>
            <p class="text-gray-400 text-xs tracking-widest mb-12 uppercase">GIGABYTE INTERACTIVE</p>
            
            <button id="main-start-btn" onclick="requestCameraAndInit()" class="btn-aorus">
                é€²å…¥ AR æŒ‘æˆ°
            </button>
            
            <p class="mt-8 text-[10px] text-gray-500 font-sans">v2.1 - ä½ˆå±€ä¿®å¾©ç‰ˆ</p>
        </div>
    </div>

    <!-- UI é‡ç–Šå±¤ -->
    <div id="ui-container" class="ui-overlay hidden">
        <div id="ar-instruction">æ­£åœ¨å°‹æ‰¾æ¨™èªŒ (Hiro Marker)...</div>

        <!-- æƒææç¤ºæ¡† -->
        <div id="start-panel" class="aorus-panel">
            <h2 class="text-[#ff6600] font-bold mb-4">æº–å‚™æƒæ</h2>
            <div class="marker-sample">
                <span>HIRO</span>
            </div>
            <p class="text-sm text-gray-300 mb-6 font-sans">è«‹å°‡é¡é ­å°æº–é›»è…¦è¢å¹•ä¸Šçš„ <br><strong>Hiro Marker</strong></p>
            <div class="w-12 h-12 border-2 border-[#ff6600] border-dashed mx-auto animate-pulse"></div>
        </div>

        <!-- å•ç­”é¢æ¿ -->
        <div id="quiz-panel" class="aorus-panel hidden text-left">
            <div id="quiz-progress" class="text-[10px] text-[#ff6600] mb-2 font-bold text-right">Q: 1 / 5</div>
            <h2 id="question-text" class="text-base font-bold mb-6"></h2>
            <div id="options-container" class="grid gap-3"></div>
        </div>

        <!-- æˆåŠŸå‹³ç«  -->
        <div id="medal-panel" class="aorus-panel hidden">
            <div class="text-5xl mb-4">ğŸ†</div>
            <h2 class="text-2xl font-bold text-[#ff6600] mb-2">æŒ‘æˆ°å®Œæˆ</h2>
            <p class="text-xs text-gray-400 mb-6 font-sans">æ‚¨å·²æˆåŠŸæŒæ¡ STEALTH æŠ€è¡“æ ¸å¿ƒ</p>
            <div class="bg-[#ff6600]/10 py-4 border border-[#ff6600]/30 rounded-lg mb-6">
                <span class="text-2xl font-black tracking-widest text-[#ff6600]">STEALTH-PRO</span>
            </div>
            <button onclick="location.reload()" class="text-xs text-gray-500 underline">é‡æ–°æŒ‘æˆ°</button>
        </div>
    </div>

    <div id="scene-container"></div>

    <script>
        const questions = [
            { q: "æŠ€å˜‰ STEALTH ç³»åˆ—æœ€ä¸»è¦çš„è¨­è¨ˆæ ¸å¿ƒæ˜¯ä»€éº¼ï¼Ÿ", o: ["ç„¡ç·šå‚³è¼¸", "èƒŒæ’å¼ä»‹é¢è¨­è¨ˆ", "è¶…å¤§å‹æ•£ç†±æ‰‡", "å…¨é€æ˜å¤–æ®¼"], a: 1 },
            { q: "èƒŒæ’å¼è¨­è¨ˆå¦‚ä½•å½±éŸ¿é›»è…¦æ•£ç†±ï¼Ÿ", o: ["å¢åŠ é¢¨æ‰‡è½‰é€Ÿ", "é™ä½é›»åŠ›æ¶ˆè€—", "ç†ç·šæ•´æ½”ä¸¦å„ªåŒ–é¢¨é“", "å¢åŠ æ©Ÿæ®¼é‡é‡"], a: 2 },
            { q: "STEALTH ç³»åˆ—é€šå¸¸æ­é…å“ªå€‹é«˜ç«¯å­å“ç‰Œï¼Ÿ", o: ["AORUS", "AERO", "EAGLE", "GAMING"], a: 0 },
            { q: "ä½¿ç”¨ STEALTH æ–¹æ¡ˆé€²è¡Œçµ„è£ï¼Œä¸»è¦èƒ½è§£æ±ºä»€éº¼ç—›é»ï¼Ÿ", o: ["ç†ç·šç¹é›œèˆ‡è¦–è¦ºæ··äº‚", "ç¡¬ç¢Ÿç©ºé–“ä¸è¶³", "é¡¯ç¤ºå¡å¤ªé‡", "è¢å¹•è§£æåº¦ä¸è¶³"], a: 0 },
            { q: "STEALTH ç³»åˆ—çš„è¦–è¦ºç‰¹é»ç‚ºä½•ï¼Ÿ", o: ["å……æ»¿å¤§é‡ RGB", "å¹¾ä¹çœ‹ä¸åˆ°å¤–éœ²ç·šæ", "æ©Ÿæ®¼å‘ˆç¾å…¨é»ƒè‰²", "éœ€è¦ä½¿ç”¨æ°´å†·"], a: 1 }
        ];

        let currentQuestion = 0;
        let markerFound = false;

        async function requestCameraAndInit() {
            try {
                // è«‹æ±‚ç›¸æ©Ÿæ¬Šé™
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { facingMode: 'environment', width: { ideal: 1280 }, height: { ideal: 720 } } 
                });
                stream.getTracks().forEach(track => track.stop());
                initAR();
            } catch (err) {
                console.error("Camera error:", err);
                document.getElementById('error-overlay').classList.remove('hidden');
            }
        }

        function initAR() {
            document.getElementById('landing-page').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('landing-page').classList.add('hidden');
                document.getElementById('ui-container').classList.remove('hidden');
            }, 500);

            // ä¿®æ­£ï¼šå‹•æ…‹è¨­ç½®é¡¯ç¤ºå¯¬é«˜ï¼Œä¸¦åœç”¨ A-Frame è‡ªå‹•ç¸®æ”¾
            const sceneHTML = `
                <a-scene 
                    embedded 
                    loading-screen="enabled: false"
                    arjs="sourceType: webcam; debugUIEnabled: false; displayWidth: ${window.innerWidth}; displayHeight: ${window.innerHeight}; canvasWidth: ${window.innerWidth}; canvasHeight: ${window.innerHeight};" 
                    renderer="antialias: true; alpha: true; precision: medium;" 
                    vr-mode-ui="enabled: false">
                    
                    <a-marker preset="hiro" id="stealth-marker">
                        <a-entity position="0 0.5 0" animation="property: rotation; to: 0 360 0; loop: true; dur: 4000; easing: linear">
                            <a-box position="0 0 0" material="color: #000; opacity: 0.8" scale="1 1 1">
                                <a-box position="0 0 0" scale="0.9 0.9 0.9" material="color: #111; emissive: #ff6600; emissiveIntensity: 0.7"></a-box>
                            </a-box>
                            <a-text value="STEALTH ACTIVE" position="0 1.2 0" align="center" color="#ff6600" width="3" font="mozillavr"></a-text>
                        </a-entity>
                    </a-marker>
                    
                    <a-entity camera></a-entity>
                </a-scene>
            `;
            document.getElementById('scene-container').innerHTML = sceneHTML;

            // å¼·åˆ¶ä½ˆå±€ä¿®æ­£è…³æœ¬ï¼šå®šæ™‚æª¢æ¸¬ï¼Œé˜²æ­¢ç›¸æ©Ÿå½±åƒç¸®å°
            const fixLayout = () => {
                const video = document.querySelector('video');
                const canvas = document.querySelector('.a-canvas');
                if (video) {
                    video.style.width = window.innerWidth + 'px';
                    video.style.height = window.innerHeight + 'px';
                    video.style.marginLeft = '0px';
                    video.style.marginTop = '0px';
                }
                if (canvas) {
                    canvas.style.width = window.innerWidth + 'px';
                    canvas.style.height = window.innerHeight + 'px';
                }
            };

            // æ¯ 500ms æª¢æŸ¥ä¸€æ¬¡ï¼ŒæŒçºŒ 3 ç§’ï¼Œç¢ºä¿å•Ÿå‹•éç¨‹ä½ˆå±€æ­£ç¢º
            let fixCount = 0;
            const fixTimer = setInterval(() => {
                fixLayout();
                if (++fixCount > 6) clearInterval(fixTimer);
            }, 500);

            // ç¶å®šæƒæäº‹ä»¶
            setTimeout(() => {
                const marker = document.querySelector('#stealth-marker');
                if (marker) {
                    marker.addEventListener('markerFound', () => {
                        if(!markerFound) triggerQuiz();
                    });
                }
            }, 2000);
        }

        function triggerQuiz() {
            markerFound = true;
            document.getElementById('ar-instruction').innerText = "åµæ¸¬æˆåŠŸï¼";
            document.getElementById('ar-instruction').style.color = "#4CAF50";
            
            setTimeout(() => {
                document.getElementById('start-panel').classList.add('hidden');
                document.getElementById('ar-instruction').classList.add('hidden');
                document.getElementById('quiz-panel').classList.remove('hidden');
                loadQuestion();
            }, 1000);
        }

        function loadQuestion() {
            const q = questions[currentQuestion];
            document.getElementById('quiz-progress').innerText = `Q: ${currentQuestion + 1} / ${questions.length}`;
            document.getElementById('question-text').innerText = q.q;
            const container = document.getElementById('options-container');
            container.innerHTML = '';
            
            q.o.forEach((option, index) => {
                const btn = document.createElement('button');
                btn.className = "w-full text-left p-4 rounded-lg bg-white/10 border border-white/20 text-white text-sm active:bg-[#ff6600] transition-all font-sans";
                btn.innerText = option;
                btn.onclick = () => {
                    if (index === q.a) {
                        btn.classList.add('bg-green-600', 'border-green-600');
                        setTimeout(() => {
                            currentQuestion++;
                            if (currentQuestion < questions.length) loadQuestion();
                            else showMedal();
                        }, 500);
                    } else {
                        btn.classList.add('bg-red-600', 'border-red-600');
                        setTimeout(() => btn.classList.remove('bg-red-600', 'border-red-600'), 500);
                    }
                };
                container.appendChild(btn);
            });
        }

        function showMedal() {
            document.getElementById('quiz-panel').classList.add('hidden');
            document.getElementById('medal-panel').classList.remove('hidden');
        }

        window.addEventListener('resize', () => {
            const video = document.querySelector('video');
            const canvas = document.querySelector('.a-canvas');
            if (video) {
                video.style.width = window.innerWidth + 'px';
                video.style.height = window.innerHeight + 'px';
            }
            if (canvas) {
                canvas.style.width = window.innerWidth + 'px';
                canvas.style.height = window.innerHeight + 'px';
            }
        });
    </script>
</body>
</html>
